<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example 1 (TLS) · GRAPE.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://juliaquantumcontrol.github.io/GRAPE.jl/examples/simple_state_to_state/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GRAPE.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../overview/">Overview</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../">List of Examples</a></li><li class="is-active"><a class="tocitem" href>Example 1 (TLS)</a><ul class="internal"><li><a class="tocitem" href="#Two-level-Hamiltonian"><span>Two-level Hamiltonian</span></a></li><li><a class="tocitem" href="#Optimization-target"><span>Optimization target</span></a></li><li><a class="tocitem" href="#Simulate-dynamics-under-the-guess-field"><span>Simulate dynamics under the guess field</span></a></li><li><a class="tocitem" href="#Optimize"><span>Optimize</span></a></li><li><a class="tocitem" href="#Simulate-the-dynamics-under-the-optimized-field"><span>Simulate the dynamics under the optimized field</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Example 1 (TLS)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example 1 (TLS)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaQuantumControl/GRAPE.jl/blob/master/examples/simple_state_to_state.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System"><a class="docs-heading-anchor" href="#Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System">Example 1: Optimization of a State-to-State Transfer in a Two-Level-System</a><a id="Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System" title="Permalink"></a></h1><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>This example is also available as a Jupyter notebook: <a href="https://nbviewer.jupyter.org/github/JuliaQuantumControl/GRAPE.jl/blob/gh-pages/dev/examples/simple_state_to_state.ipynb"><code>simple_state_to_state.ipynb</code></a>.</p><p>Compare this example against the <a href="https://qucontrol.github.io/krotov/v1.2.1/notebooks/01_example_simple_state_to_state.html">same example using the <code>krotov</code> Python package</a>.</p></div></div><p><span>$\gdef\op#1{\hat{#1}}$</span> <span>$\gdef\init{\text{init}}$</span> <span>$\gdef\tgt{\text{tgt}}$</span></p><p>This first example illustrates the basic use of the <code>Krotov.jl</code> by solving a simple canonical optimization problem: the transfer of population in a two level system.</p><pre><code class="language-julia hljs">using Printf
using QuantumControl
using LinearAlgebra
using Optim
using GRAPE # XXX
using QuantumControlBase: chain_infohooks
using GRAPELinesearchAnalysis
using LineSearches
using PyPlot: matplotlib
matplotlib.use(&quot;Agg&quot;)</code></pre><h2 id="Two-level-Hamiltonian"><a class="docs-heading-anchor" href="#Two-level-Hamiltonian">Two-level Hamiltonian</a><a id="Two-level-Hamiltonian-1"></a><a class="docs-heading-anchor-permalink" href="#Two-level-Hamiltonian" title="Permalink"></a></h2><p>We consider the Hamiltonian <span>$\op{H}_{0} = - \frac{\omega}{2} \op{\sigma}_{z}$</span>, representing a simple qubit with energy level splitting <span>$\omega$</span> in the basis <span>$\{\ket{0},\ket{1}\}$</span>. The control field <span>$\epsilon(t)$</span> is assumed to couple via the Hamiltonian <span>$\op{H}_{1}(t) = \epsilon(t) \op{\sigma}_{x}$</span> to the qubit, i.e., the control field effectively drives transitions between both qubit states.</p><p>We we will use</p><pre><code class="language-julia hljs">ϵ(t) = 0.2 * QuantumControl.shapes.flattop(t, T = 5, t_rise = 0.3, func = :blackman);</code></pre><pre><code class="language-julia hljs">&quot;&quot;&quot;Two-level-system Hamiltonian.&quot;&quot;&quot;
function hamiltonian(Ω = 1.0, ϵ = ϵ)
    σ̂_z = ComplexF64[1 0; 0 -1]
    σ̂_x = ComplexF64[0 1; 1 0]
    Ĥ₀ = -0.5 * Ω * σ̂_z
    Ĥ₁ = σ̂_x
    return (Ĥ₀, (Ĥ₁, ϵ))
end;</code></pre><pre><code class="language-julia hljs">H = hamiltonian();</code></pre><p>The control field here switches on from zero at <span>$t=0$</span> to it&#39;s maximum amplitude 0.2 within the time period 0.3 (the switch-on shape is half a <a href="https://en.wikipedia.org/wiki/Window_function#Blackman_window">Blackman pulse</a>). It switches off again in the time period 0.3 before the final time <span>$T=5$</span>). We use a time grid with 500 time steps between 0 and <span>$T$</span>:</p><pre><code class="language-julia hljs">tlist = collect(range(0, 5, length = 500));</code></pre><pre><code class="language-julia hljs">function plot_control(pulse::Vector, tlist)
    fig, ax = matplotlib.pyplot.subplots(figsize = (6, 3))
    ax.plot(tlist, pulse)
    ax.set_xlabel(&quot;time&quot;)
    ax.set_ylabel(&quot;amplitude&quot;)
    return fig
end

plot_control(ϵ::T, tlist) where {T&lt;:Function} = plot_control([ϵ(t) for t in tlist], tlist)

plot_control(H[2][2], tlist)</code></pre><img src="data:image/png;base64,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" /><h2 id="Optimization-target"><a class="docs-heading-anchor" href="#Optimization-target">Optimization target</a><a id="Optimization-target-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-target" title="Permalink"></a></h2><p>The <code>krotov</code> package requires the goal of the optimization to be described by a list of <code>Objective</code> instances. In this example, there is only a single objective: the state-to-state transfer from initial state <span>$\ket{\Psi_{\init}} = \ket{0}$</span> to the target state <span>$\ket{\Psi_{\tgt}} = \ket{1}$</span>, under the dynamics of the Hamiltonian <span>$\op{H}(t)$</span>:</p><pre><code class="language-julia hljs">function ket(label)
    result = Dict(&quot;0&quot; =&gt; Vector{ComplexF64}([1, 0]), &quot;1&quot; =&gt; Vector{ComplexF64}([0, 1]))
    return result[string(label)]
end;</code></pre><pre><code class="language-julia hljs">objectives = [Objective(initial_state = ket(0), generator = H, target_state = ket(1))]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{QuantumControlBase.Objective{Vector{ComplexF64}, Tuple{Matrix{ComplexF64}, Tuple{Matrix{ComplexF64}, typeof(Main.ϵ)}}}}:
 QuantumControlBase.Objective{Vector{ComplexF64}, Tuple{Matrix{ComplexF64}, Tuple{Matrix{ComplexF64}, typeof(Main.ϵ)}}}(ComplexF64[1.0 + 0.0im, 0.0 + 0.0im], (ComplexF64[-0.5 - 0.0im -0.0 - 0.0im; -0.0 - 0.0im 0.5 - 0.0im], (ComplexF64[0.0 + 0.0im 1.0 + 0.0im; 1.0 + 0.0im 0.0 + 0.0im], Main.ϵ)), ComplexF64[0.0 + 0.0im, 1.0 + 0.0im])</code></pre><pre><code class="language-julia hljs">problem = ControlProblem(
    objectives = objectives,
    tlist = tlist,
    pulse_options=Dict(),
    iter_stop = 500,
    J_T = QuantumControl.functionals.J_T_sm,
    gradient=QuantumControl.functionals.grad_J_T_sm!,
    check_convergence = res -&gt; begin
        ((res.J_T &lt; 1e-3) &amp;&amp; (res.converged = true) &amp;&amp; (res.message = &quot;J_T &lt; 10⁻³&quot;))
    end,
);</code></pre><h2 id="Simulate-dynamics-under-the-guess-field"><a class="docs-heading-anchor" href="#Simulate-dynamics-under-the-guess-field">Simulate dynamics under the guess field</a><a id="Simulate-dynamics-under-the-guess-field-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-dynamics-under-the-guess-field" title="Permalink"></a></h2><p>Before running the optimization procedure, we first simulate the dynamics under the guess field <span>$\epsilon_{0}(t)$</span>. The following solves equation of motion for the defined objective, which contains the initial state <span>$\ket{\Psi_{\init}}$</span> and the Hamiltonian <span>$\op{H}(t)$</span> defining its evolution.</p><pre><code class="language- hljs">guess_dynamics = propagate_objective(
    objectives[1],
    problem.tlist;
    storage = true,
    observables = (Ψ -&gt; abs.(Ψ) .^ 2,),
)</code></pre><pre><code class="language- hljs">function plot_population(pop0::Vector, pop1::Vector, tlist)
    fig, ax = matplotlib.pyplot.subplots(figsize = (6, 3))
    ax.plot(tlist, pop0, label = &quot;0&quot;)
    ax.plot(tlist, pop1, label = &quot;1&quot;)
    ax.legend()
    ax.set_xlabel(&quot;time&quot;)
    ax.set_ylabel(&quot;population&quot;)
    return fig
end

plot_population(guess_dynamics[1,:], guess_dynamics[2,:], tlist)</code></pre><h2 id="Optimize"><a class="docs-heading-anchor" href="#Optimize">Optimize</a><a id="Optimize-1"></a><a class="docs-heading-anchor-permalink" href="#Optimize" title="Permalink"></a></h2><p>In the following we optimize the guess field <span>$\epsilon_{0}(t)$</span> such that the intended state-to-state transfer <span>$\ket{\Psi_{\init}} \rightarrow \ket{\Psi_{\tgt}}$</span> is solved.</p><pre><code class="language-julia hljs">opt_result = optimize_grape(
        problem,
        #=show_trace=true, extended_trace=false,=#
        info_hook=chain_infohooks(
            GRAPELinesearchAnalysis.plot_linesearch(@__DIR__),
            GRAPE.print_table,
        )
        #=alphaguess=LineSearches.InitialStatic(alpha=0.2),=#
        #=linesearch=LineSearches.HagerZhang(alphamax=2.0),=#
        #=linesearch=LineSearches.BackTracking(), # fails=#
        #=allow_f_increases=true,=#
);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"> iter.        J_T     |∇J_T|       ΔJ_T    secs
     0   9.51e-01   5.40e-02        n/a     0.0
     1   4.45e-02   5.40e-02  -9.07e-01    16.0
     2   1.89e-02   6.57e-02  -2.56e-02     3.0
     3   5.75e-03   4.38e-02  -1.31e-02     1.1
     4   1.03e-05   2.33e-02  -5.74e-03     1.3</code></pre><pre><code class="language-julia hljs">opt_result</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GRAPE Optimization Result
-------------------------
- Started at 2021-12-27T20:46:52.254
- Number of objectives: 1
- Number of iterations: 4
- Number of pure func evals: 0
- Number of func/grad evals: 10
- Value of functional: 1.02765e-05
- Reason for termination: J_T &lt; 10⁻³
- Ended at 2021-12-27T20:47:15.143 (22 seconds, 889 milliseconds)
</code></pre><p>We can plot the optimized field:</p><pre><code class="language-julia hljs">plot_control(opt_result.optimized_controls[1], tlist)</code></pre><img src="data:image/png;base64,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" /><h2 id="Simulate-the-dynamics-under-the-optimized-field"><a class="docs-heading-anchor" href="#Simulate-the-dynamics-under-the-optimized-field">Simulate the dynamics under the optimized field</a><a id="Simulate-the-dynamics-under-the-optimized-field-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-the-dynamics-under-the-optimized-field" title="Permalink"></a></h2><p>Having obtained the optimized control field, we can simulate the dynamics to verify that the optimized field indeed drives the initial state <span>$\ket{\Psi_{\init}} = \ket{0}$</span> to the desired target state <span>$\ket{\Psi_{\tgt}} = \ket{1}$</span>.</p><pre><code class="language- hljs">opt_dynamics = propagate_objective(
    objectives[1],
    problem.tlist;
    controls_map = IdDict(ϵ =&gt; opt_result.optimized_controls[1]),
    storage = true,
    observables = (Ψ -&gt; abs.(Ψ) .^ 2,),
)</code></pre><pre><code class="language- hljs">plot_population(opt_dynamics[1,:], opt_dynamics[2,:], tlist)</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« List of Examples</a><a class="docs-footer-nextpage" href="../../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Monday 27 December 2021 20:47">Monday 27 December 2021</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
