<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Example 1 (TLS) · GRAPE.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://juliaquantumcontrol.github.io/GRAPE.jl/examples/simple_state_to_state/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GRAPE.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../overview/">Overview</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../">List of Examples</a></li><li class="is-active"><a class="tocitem" href>Example 1 (TLS)</a><ul class="internal"><li><a class="tocitem" href="#Two-level-Hamiltonian"><span>Two-level Hamiltonian</span></a></li><li><a class="tocitem" href="#Optimization-target"><span>Optimization target</span></a></li><li><a class="tocitem" href="#Simulate-dynamics-under-the-guess-field"><span>Simulate dynamics under the guess field</span></a></li><li><a class="tocitem" href="#Optimize"><span>Optimize</span></a></li><li><a class="tocitem" href="#Simulate-the-dynamics-under-the-optimized-field"><span>Simulate the dynamics under the optimized field</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Example 1 (TLS)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Example 1 (TLS)</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaQuantumControl/GRAPE.jl/blob/master/examples/simple_state_to_state.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System"><a class="docs-heading-anchor" href="#Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System">Example 1: Optimization of a State-to-State Transfer in a Two-Level-System</a><a id="Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System-1"></a><a class="docs-heading-anchor-permalink" href="#Example-1:-Optimization-of-a-State-to-State-Transfer-in-a-Two-Level-System" title="Permalink"></a></h1><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>This example is also available as a Jupyter notebook: <a href="https://nbviewer.jupyter.org/github/JuliaQuantumControl/GRAPE.jl/blob/gh-pages/dev/examples/simple_state_to_state.ipynb"><code>simple_state_to_state.ipynb</code></a>.</p><p>Compare this example against the <a href="https://qucontrol.github.io/krotov/v1.2.1/notebooks/01_example_simple_state_to_state.html">same example using the <code>krotov</code> Python package</a>.</p></div></div><p><span>$\gdef\op#1{\hat{#1}}$</span> <span>$\gdef\init{\text{init}}$</span> <span>$\gdef\tgt{\text{tgt}}$</span></p><p>This first example illustrates the basic use of the <code>Krotov.jl</code> by solving a simple canonical optimization problem: the transfer of population in a two level system.</p><pre><code class="language- hljs">using QuantumControl
using LinearAlgebra
using Optim
using GRAPE # XXX
using LineSearches</code></pre><h2 id="Two-level-Hamiltonian"><a class="docs-heading-anchor" href="#Two-level-Hamiltonian">Two-level Hamiltonian</a><a id="Two-level-Hamiltonian-1"></a><a class="docs-heading-anchor-permalink" href="#Two-level-Hamiltonian" title="Permalink"></a></h2><p>We consider the Hamiltonian <span>$\op{H}_{0} = - \frac{\omega}{2} \op{\sigma}_{z}$</span>, representing a simple qubit with energy level splitting <span>$\omega$</span> in the basis <span>$\{\ket{0},\ket{1}\}$</span>. The control field <span>$\epsilon(t)$</span> is assumed to couple via the Hamiltonian <span>$\op{H}_{1}(t) = \epsilon(t) \op{\sigma}_{x}$</span> to the qubit, i.e., the control field effectively drives transitions between both qubit states.</p><p>We we will use</p><pre><code class="language-julia hljs">ϵ(t) = 0.2 * QuantumControl.shapes.flattop(t, T = 5, t_rise = 0.3, func = :blackman);</code></pre><pre><code class="language-julia hljs">&quot;&quot;&quot;Two-level-system Hamiltonian.&quot;&quot;&quot;
function hamiltonian(Ω = 1.0, ϵ = ϵ)
    σ̂_z = ComplexF64[1 0; 0 -1]
    σ̂_x = ComplexF64[0 1; 1 0]
    Ĥ₀ = -0.5 * Ω * σ̂_z
    Ĥ₁ = σ̂_x
    return (Ĥ₀, (Ĥ₁, ϵ))
end;</code></pre><pre><code class="language-julia hljs">H = hamiltonian();</code></pre><p>The control field here switches on from zero at <span>$t=0$</span> to it&#39;s maximum amplitude 0.2 within the time period 0.3 (the switch-on shape is half a <a href="https://en.wikipedia.org/wiki/Window_function#Blackman_window">Blackman pulse</a>). It switches off again in the time period 0.3 before the final time <span>$T=5$</span>). We use a time grid with 500 time steps between 0 and <span>$T$</span>:</p><pre><code class="language-julia hljs">tlist = collect(range(0, 5, length = 500));</code></pre><pre><code class="language-julia hljs">using PyPlot
matplotlib.use(&quot;Agg&quot;)

function plot_control(pulse::Vector, tlist)
    fig, ax = matplotlib.pyplot.subplots(figsize = (6, 3))
    ax.plot(tlist, pulse)
    ax.set_xlabel(&quot;time&quot;)
    ax.set_ylabel(&quot;amplitude&quot;)
    return fig
end

plot_control(ϵ::T, tlist) where {T&lt;:Function} = plot_control([ϵ(t) for t in tlist], tlist)

plot_control(H[2][2], tlist)</code></pre><img src="data:image/png;base64,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" /><h2 id="Optimization-target"><a class="docs-heading-anchor" href="#Optimization-target">Optimization target</a><a id="Optimization-target-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-target" title="Permalink"></a></h2><p>The <code>krotov</code> package requires the goal of the optimization to be described by a list of <code>Objective</code> instances. In this example, there is only a single objective: the state-to-state transfer from initial state <span>$\ket{\Psi_{\init}} = \ket{0}$</span> to the target state <span>$\ket{\Psi_{\tgt}} = \ket{1}$</span>, under the dynamics of the Hamiltonian <span>$\op{H}(t)$</span>:</p><pre><code class="language-julia hljs">function ket(label)
    result = Dict(&quot;0&quot; =&gt; Vector{ComplexF64}([1, 0]), &quot;1&quot; =&gt; Vector{ComplexF64}([0, 1]))
    return result[string(label)]
end;</code></pre><pre><code class="language-julia hljs">objectives = [Objective(initial_state = ket(0), generator = H, target_state = ket(1))]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{QuantumControlBase.Objective{Vector{ComplexF64}, Tuple{Matrix{ComplexF64}, Tuple{Matrix{ComplexF64}, typeof(Main.ϵ)}}}}:
 QuantumControlBase.Objective{Vector{ComplexF64}, Tuple{Matrix{ComplexF64}, Tuple{Matrix{ComplexF64}, typeof(Main.ϵ)}}}(ComplexF64[1.0 + 0.0im, 0.0 + 0.0im], (ComplexF64[-0.5 - 0.0im -0.0 - 0.0im; -0.0 - 0.0im 0.5 - 0.0im], (ComplexF64[0.0 + 0.0im 1.0 + 0.0im; 1.0 + 0.0im 0.0 + 0.0im], Main.ϵ)), ComplexF64[0.0 + 0.0im, 1.0 + 0.0im])</code></pre><pre><code class="language-julia hljs">problem = ControlProblem(
    objectives = objectives,
    tlist = tlist,
    pulse_options=Dict(),
    iter_stop = 500,
    J_T = QuantumControl.functionals.J_T_sm,
    gradient=QuantumControl.functionals.grad_J_T_sm!,
    check_convergence = res -&gt; begin
        ((res.J_T &lt; 1e-3) &amp;&amp; (res.converged = true) &amp;&amp; (res.message = &quot;J_T &lt; 10⁻³&quot;))
    end,
);</code></pre><h2 id="Simulate-dynamics-under-the-guess-field"><a class="docs-heading-anchor" href="#Simulate-dynamics-under-the-guess-field">Simulate dynamics under the guess field</a><a id="Simulate-dynamics-under-the-guess-field-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-dynamics-under-the-guess-field" title="Permalink"></a></h2><p>Before running the optimization procedure, we first simulate the dynamics under the guess field <span>$\epsilon_{0}(t)$</span>. The following solves equation of motion for the defined objective, which contains the initial state <span>$\ket{\Psi_{\init}}$</span> and the Hamiltonian <span>$\op{H}(t)$</span> defining its evolution.</p><pre><code class="language-julia hljs">guess_dynamics = propagate(
    objectives[1],
    problem.tlist;
    storage = true,
    observables = (Ψ -&gt; abs.(Ψ) .^ 2,),
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×500 Matrix{Float64}:
 1.0  1.0          1.0          1.0          …  0.951457   0.951459  0.951459
 0.0  7.73456e-40  2.03206e-11  2.96638e-10     0.0485427  0.048541  0.048541</code></pre><pre><code class="language-julia hljs">function plot_population(pop0::Vector, pop1::Vector, tlist)
    fig, ax = matplotlib.pyplot.subplots(figsize = (6, 3))
    ax.plot(tlist, pop0, label = &quot;0&quot;)
    ax.plot(tlist, pop1, label = &quot;1&quot;)
    ax.legend()
    ax.set_xlabel(&quot;time&quot;)
    ax.set_ylabel(&quot;population&quot;)
    return fig
end

plot_population(guess_dynamics[1,:], guess_dynamics[2,:], tlist)</code></pre><img src="data:image/png;base64,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" /><h2 id="Optimize"><a class="docs-heading-anchor" href="#Optimize">Optimize</a><a id="Optimize-1"></a><a class="docs-heading-anchor-permalink" href="#Optimize" title="Permalink"></a></h2><p>In the following we optimize the guess field <span>$\epsilon_{0}(t)$</span> such that the intended state-to-state transfer <span>$\ket{\Psi_{\init}} \rightarrow \ket{\Psi_{\tgt}}$</span> is solved.</p><pre><code class="language- hljs">opt_result = optimize_grape(
        problem,
        show_trace=true, extended_trace=false,
        info_hook=(args...) -&gt; nothing,
        alphaguess=LineSearches.InitialStatic(alpha=0.2),
        linesearch=LineSearches.HagerZhang(alphamax=2.0),
        #=linesearch=LineSearches.BackTracking(), # fails=#
        allow_f_increases=true,
);
nothing #hide</code></pre><pre><code class="language- hljs">opt_result</code></pre><p>We can plot the optimized field:</p><pre><code class="language- hljs">plot_control(opt_result.optimized_controls[1], tlist)</code></pre><h2 id="Simulate-the-dynamics-under-the-optimized-field"><a class="docs-heading-anchor" href="#Simulate-the-dynamics-under-the-optimized-field">Simulate the dynamics under the optimized field</a><a id="Simulate-the-dynamics-under-the-optimized-field-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-the-dynamics-under-the-optimized-field" title="Permalink"></a></h2><p>Having obtained the optimized control field, we can simulate the dynamics to verify that the optimized field indeed drives the initial state <span>$\ket{\Psi_{\init}} = \ket{0}$</span> to the desired target state <span>$\ket{\Psi_{\tgt}} = \ket{1}$</span>.</p><pre><code class="language- hljs">opt_dynamics = propagate(
    objectives[1],
    problem.tlist;
    controls_map = IdDict(ϵ =&gt; opt_result.optimized_controls[1]),
    storage = true,
    observables = (Ψ -&gt; abs.(Ψ) .^ 2,),
)</code></pre><pre><code class="language- hljs">plot_population(opt_dynamics[1,:], opt_dynamics[2,:], tlist)</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« List of Examples</a><a class="docs-footer-nextpage" href="../../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.9 on <span class="colophon-date" title="Tuesday 19 October 2021 04:14">Tuesday 19 October 2021</span>. Using Julia version 1.6.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
